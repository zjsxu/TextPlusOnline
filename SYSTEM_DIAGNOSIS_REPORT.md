# ğŸ¥ TextDiff+ Analytics System å®Œæ•´è¯Šæ–­æŠ¥å‘Š

## ğŸ“‹ è¯Šæ–­æ¦‚è¿°

**è¯Šæ–­æ—¶é—´**: 2025-12-12 03:34  
**é—®é¢˜æè¿°**: ç”¨æˆ·æ“ä½œæ•°æ®æ²¡æœ‰è¢«å½•å…¥åŠŸèƒ½ä½¿ç”¨å’Œæœ€è¿‘äº‹ä»¶  
**è¯Šæ–­ç»“æœ**: åå°ç³»ç»Ÿå®Œå…¨æ­£å¸¸ï¼Œé—®é¢˜åœ¨å‰ç«¯é›†æˆ

## âœ… åå°ç³»ç»Ÿæ£€æŸ¥ç»“æœ

### 1. APIç«¯ç‚¹æµ‹è¯• - å…¨éƒ¨é€šè¿‡ âœ…

| ç«¯ç‚¹ | çŠ¶æ€ | åŠŸèƒ½ |
|------|------|------|
| `GET /health` | âœ… æ­£å¸¸ | å¥åº·æ£€æŸ¥ |
| `POST /api/analytics/events/page-view` | âœ… æ­£å¸¸ | é¡µé¢è®¿é—®äº‹ä»¶ |
| `POST /api/analytics/events/feature-usage` | âœ… æ­£å¸¸ | åŠŸèƒ½ä½¿ç”¨äº‹ä»¶ |
| `POST /api/analytics/events/session` | âœ… æ­£å¸¸ | ä¼šè¯äº‹ä»¶ |
| `POST /api/analytics/events/batch` | âœ… æ­£å¸¸ | æ‰¹é‡äº‹ä»¶å¤„ç† |
| `GET /api/analytics/real-time` | âœ… æ­£å¸¸ | å®æ—¶ç»Ÿè®¡æŸ¥è¯¢ |

### 2. æ•°æ®å¤„ç†éªŒè¯ - å®Œå…¨æ­£ç¡® âœ…

**æµ‹è¯•å‰çŠ¶æ€**:
- åœ¨çº¿ç”¨æˆ·: 1
- åŠŸèƒ½ä½¿ç”¨: {"text_comparison": 1}
- æœ€è¿‘äº‹ä»¶: 2ä¸ª

**æµ‹è¯•åçŠ¶æ€**:
- åœ¨çº¿ç”¨æˆ·: 2 (æ­£ç¡®å¢åŠ )
- åŠŸèƒ½ä½¿ç”¨: {"text_comparison": 1, "diagnostic_test": 1} (æ­£ç¡®æ›´æ–°)
- æœ€è¿‘äº‹ä»¶: 7ä¸ª (æ­£ç¡®å¢åŠ )

### 3. å®æ—¶ç»Ÿè®¡åŠŸèƒ½ - å®Œå…¨æ­£å¸¸ âœ…

- âœ… åœ¨çº¿ç”¨æˆ·æ•°ç»Ÿè®¡å‡†ç¡®
- âœ… ä¼šè¯ç®¡ç†æ­£ç¡® (5åˆ†é’Ÿè¶…æ—¶)
- âœ… åŠŸèƒ½ä½¿ç”¨ç»Ÿè®¡å®æ—¶æ›´æ–°
- âœ… æœ€è¿‘äº‹ä»¶åˆ—è¡¨æ­£ç¡®ç»´æŠ¤
- âœ… æ‰¹é‡äº‹ä»¶å¤„ç†æ­£å¸¸

## âŒ å‰ç«¯é›†æˆé—®é¢˜åˆ†æ

### å¯èƒ½çš„é—®é¢˜åŸå› 

1. **åå°URLæœªé…ç½®** ğŸ”§
   - å‰ç«¯analytics.jså¯èƒ½æ²¡æœ‰æ­£ç¡®é…ç½®åå°æœåŠ¡åœ°å€
   - éœ€è¦æ‰‹åŠ¨é…ç½®æˆ–æ£€æŸ¥è‡ªåŠ¨æ£€æµ‹é€»è¾‘

2. **CORSè·¨åŸŸé—®é¢˜** ğŸŒ
   - æµè§ˆå™¨å¯èƒ½é˜»æ­¢äº†è·¨åŸŸè¯·æ±‚
   - éœ€è¦æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

3. **Analyticså¯¹è±¡æœªåˆå§‹åŒ–** âš ï¸
   - TextDiff+ç½‘ç«™å¯èƒ½æ²¡æœ‰æ­£ç¡®åŠ è½½analytics.js
   - æˆ–è€…åˆå§‹åŒ–æ—¶å‡ºç°äº†é”™è¯¯

4. **äº‹ä»¶å‘é€å¤±è´¥** ğŸ“¡
   - ç½‘ç»œè¯·æ±‚å¯èƒ½å¤±è´¥ä½†è¢«é™é»˜å¤„ç†
   - éœ€è¦æ£€æŸ¥å®é™…çš„ç½‘ç»œè¯·æ±‚

## ğŸ” è¯¦ç»†è¯Šæ–­æ­¥éª¤

### æ­¥éª¤1: æ£€æŸ¥å‰ç«¯é…ç½®

è®¿é—®è¯Šæ–­é¡µé¢: http://localhost:8080/frontend-debug.html

**æ£€æŸ¥é¡¹ç›®**:
- [ ] Analyticså¯¹è±¡æ˜¯å¦åˆå§‹åŒ–
- [ ] åå°URLæ˜¯å¦é…ç½®
- [ ] å…¨å±€é…ç½®æ˜¯å¦å­˜åœ¨
- [ ] æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

### æ­¥éª¤2: æµ‹è¯•å‰ç«¯å‘é€åŠŸèƒ½

åœ¨è¯Šæ–­é¡µé¢ä¸­:
1. ç‚¹å‡»"é…ç½®åå°æœåŠ¡"
2. ç‚¹å‡»"æµ‹è¯•é¡µé¢è®¿é—®"
3. ç‚¹å‡»"æµ‹è¯•åŠŸèƒ½ä½¿ç”¨"
4. ç‚¹å‡»"æµ‹è¯•æ‰¹é‡å‘é€"
5. è§‚å¯Ÿæ—¥å¿—è¾“å‡º

### æ­¥éª¤3: æ£€æŸ¥ç½‘ç»œè¯·æ±‚

æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·:
1. åˆ‡æ¢åˆ°Networkæ ‡ç­¾
2. åœ¨TextDiff+ç½‘ç«™ä¸­è¿›è¡Œæ“ä½œ
3. æŸ¥çœ‹æ˜¯å¦æœ‰å‘é€åˆ° `localhost:3001` çš„è¯·æ±‚
4. æ£€æŸ¥è¯·æ±‚çŠ¶æ€å’Œå“åº”

### æ­¥éª¤4: éªŒè¯æ•°æ®æµ

```bash
# å®æ—¶ç›‘æ§åå°æ—¥å¿—
# åœ¨ä¸€ä¸ªç»ˆç«¯ä¸­è¿è¡Œï¼Œç„¶ååœ¨ç½‘ç«™ä¸­æ“ä½œ
watch -n 1 'curl -s http://localhost:3001/api/analytics/real-time | jq ".data.recentEvents[-3:]"'
```

## ğŸ›  ä¿®å¤å»ºè®®

### æ–¹æ¡ˆ1: æ‰‹åŠ¨é…ç½®åå°è¿æ¥

åœ¨TextDiff+ç½‘ç«™ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç :
```javascript
// åœ¨é¡µé¢åŠ è½½åæ‰§è¡Œ
window.addEventListener('load', () => {
    if (window.textDiffAnalytics) {
        window.textDiffAnalytics.configureBackend({
            backendUrl: 'http://localhost:3001/api/analytics',
            batchInterval: 30000,
            enabled: true
        });
        console.log('Analytics backend configured');
    }
});
```

### æ–¹æ¡ˆ2: æ£€æŸ¥CORSè®¾ç½®

ç¡®ä¿åå°æœåŠ¡å…è®¸æ¥è‡ªå‰ç«¯çš„è¯·æ±‚:
```javascript
// åœ¨test-simple.jsä¸­å·²ç»è®¾ç½®äº†CORS
app.use(cors());
```

### æ–¹æ¡ˆ3: æ·»åŠ è°ƒè¯•æ—¥å¿—

åœ¨analytics.jsä¸­æ·»åŠ æ›´å¤šè°ƒè¯•ä¿¡æ¯:
```javascript
// åœ¨sendToBackendå‡½æ•°ä¸­æ·»åŠ 
console.log('Sending to backend:', url, data);
```

## ğŸ“Š å½“å‰ç³»ç»ŸçŠ¶æ€

### åå°æœåŠ¡ âœ…
- **çŠ¶æ€**: è¿è¡Œæ­£å¸¸
- **ç«¯å£**: 3001
- **ç‰ˆæœ¬**: 1.0.0-test
- **è¿è¡Œæ—¶é—´**: 10+ åˆ†é’Ÿ
- **å¤„ç†äº‹ä»¶**: 7ä¸ª

### å‰ç«¯æœåŠ¡ âœ…
- **çŠ¶æ€**: è¿è¡Œæ­£å¸¸
- **ç«¯å£**: 8080
- **Analyticsè„šæœ¬**: å·²åŠ è½½
- **é…ç½®çŠ¶æ€**: å¾…æ£€æŸ¥

### æ•°æ®åº“ âœ…
- **ç±»å‹**: å†…å­˜å­˜å‚¨ (æµ‹è¯•æ¨¡å¼)
- **åœ¨çº¿ç”¨æˆ·**: 2ä¸ªæ´»è·ƒä¼šè¯
- **äº‹ä»¶å­˜å‚¨**: 7ä¸ªäº‹ä»¶
- **åŠŸèƒ½ç»Ÿè®¡**: 2ç§åŠŸèƒ½

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œ
1. **è®¿é—®è¯Šæ–­é¡µé¢**: http://localhost:8080/frontend-debug.html
2. **æ£€æŸ¥å‰ç«¯é…ç½®çŠ¶æ€**
3. **æµ‹è¯•äº‹ä»¶å‘é€åŠŸèƒ½**
4. **æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯**

### å¦‚æœé—®é¢˜æŒç»­
1. **æ£€æŸ¥TextDiff+ç½‘ç«™æ˜¯å¦æ­£ç¡®åŠ è½½analytics.js**
2. **éªŒè¯ç½‘ç«™åŸŸåæ˜¯å¦åœ¨CORSå…è®¸åˆ—è¡¨ä¸­**
3. **è€ƒè™‘ä½¿ç”¨å®Œæ•´ç‰ˆåå°æœåŠ¡ (å¸¦æ•°æ®åº“)**

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·æä¾›:
1. æµè§ˆå™¨æ§åˆ¶å°çš„å®Œæ•´é”™è¯¯ä¿¡æ¯
2. Networkæ ‡ç­¾ä¸­çš„è¯·æ±‚è¯¦æƒ…
3. å‰ç«¯è¯Šæ–­é¡µé¢çš„æ£€æŸ¥ç»“æœ
4. å…·ä½“çš„æ“ä½œæ­¥éª¤å’Œé¢„æœŸç»“æœ

## ğŸ”„ ç³»ç»ŸéªŒè¯å‘½ä»¤

```bash
# æ£€æŸ¥åå°å¥åº·
curl http://localhost:3001/health

# æŸ¥çœ‹å®æ—¶æ•°æ®
curl -s http://localhost:3001/api/analytics/real-time | jq

# å‘é€æµ‹è¯•äº‹ä»¶
curl -X POST http://localhost:3001/api/analytics/events/feature-usage \
  -H "Content-Type: application/json" \
  -d '{"sessionId":"test","feature":"manual_test","action":"test"}'

# ç›‘æ§æ•°æ®å˜åŒ–
watch -n 2 'curl -s http://localhost:3001/api/analytics/real-time | jq ".data.featureUsage"'
```

---

**ç»“è®º**: åå°ç³»ç»ŸåŠŸèƒ½å®Œå…¨æ­£å¸¸ï¼Œé—®é¢˜å‡ºç°åœ¨å‰ç«¯é›†æˆç¯èŠ‚ã€‚å»ºè®®ä½¿ç”¨è¯Šæ–­å·¥å…·è¿›è¡Œè¯¦ç»†æ’æŸ¥ã€‚